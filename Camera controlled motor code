# include <stdio.h>
# include <time.h>


extern "C" int init(int d_lev);
extern "C" int Sleep(int sec, int usec);
extern "C" int set_motor(int motor, int speed);
extern "C" int take_picture();
extern "C" char get_pixel(int row, int col, int colour);

extern "C" int init(int d_lev);
extern "C" int connect_to_server( char server_addr[15],int port);
extern "C" int send_to_server(char message[24]);
extern "C" int receive_from_server(char message[24]);

int main(){         //sets up the RPi hardware and checks that everything is working correctly
    init(0);        // This sets up the RPi hardware and ensures everything is working correctly
   init(1);
   connect_to_server("130.195.6.196", 1024);        //sends a message to the connected server
   send_to_server("Hello server");              //receives message from the connected server
   char message[24];
   receive_from_server(message);        //this may be buggy!
   printf("%s", message);

    char c;
    int setMotor;
    while(true){
        take_picture();
        c = get_pixel(160, 120, 3);
        printf("%d\n", c);
        if(c > 100){
        setMotor = 100;
        } else {
        setMotor = 0;
        }
        set_motor(1, setMotor);
        set_motor(2, setMotor);
    }

return 0;
}
